{#
A list of pages in a menu at the side of a page.

Expects:

* menu_pages - A list or PageQuerySet of pages to link to.
* page - The current Page
* title - optional, the title for the menu. If falsey, the section page's title will be used.
#}

{% if menu_pages %}
    {% if title %}
        <h2>{{ title }}</h2>
    {% else %}

        {% with section_page=page.section_page() %}
            {% if section_page %}
                <h2>{{ section_page.title }}</h2>
            {% endif %}
        {% endwith %}
    {% endif %}
    <ul>
        {% for p in menu_pages %}
            <li class="{% if p.pk == page.pk %}current{% endif %}">
                {% if p.pk == page.pk %}
                    {{ p.title }}
                {% else %}
                    <a href="{{ p.url }}">{{ p.title }}</a>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% endif %}
